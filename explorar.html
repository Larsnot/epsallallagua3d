<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorar 3D | EPSA-Llallagua</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="icon" type="image/x-icon" href="images/zyro-image2.ico">
    
    <!-- Three.js y controles -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/MTLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FBXLoader.js"></script>
</head>
<body>
    <!-- Header/Navigation -->
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="navbar-brand">
                    <a href="index.html" style="display: flex; align-items: center; gap: var(--space-sm); text-decoration: none;">
                        <img src="images/LOGO-EPSA.png" alt="EPSA Logo" class="logo">
                        <span class="brand-text">EPSA BUSTILLO</span>
                    </a>
                </div>
                
                <div class="navbar-nav" id="navbarNav">
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">Inicio</a>
                        </li>
                        <li class="nav-item">
                            <a href="institucion.html" class="nav-link">Instituci贸n</a>
                        </li>
                        <li class="nav-item">
                            <a href="servicios.html" class="nav-link">Servicios</a>
                        </li>
                        <li class="nav-item">
                            <a href="historia.html" class="nav-link">Historia</a>
                        </li>
                        <li class="nav-item">
                            <a href="galeria.html" class="nav-link">Galer铆a</a>
                        </li>
                        <li class="nav-item">
                            <a href="noticias.html" class="nav-link">Noticias</a>
                        </li>
                        <li class="nav-item">
                            <a href="explorar.html" class="nav-link active">Explorar</a>
                        </li>
                        <li class="nav-item">
                            <a href="contacto.html" class="nav-link">Contacto</a>
                        </li>
                    </ul>
                </div>
                
                <div class="navbar-actions">
                    <a href="#" class="btn btn-primary" id="downloadInvoice">Descargar Factura</a>
                    <button class="mobile-menu-toggle" id="mobileMenuToggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-background">
            <img src="images/portada-water.jpg" alt="EPSA Infrastructure">
            <div class="hero-overlay"></div>
        </div>
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Explora Nuestra Infraestructura</h1>
                <p class="hero-subtitle">Visualizaci贸n 3D interactiva de las instalaciones de EPSA-Llallagua</p>
                <div class="hero-actions">
                    <a href="#viewer" class="btn btn-primary">Comenzar Exploraci贸n</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            
            <!-- File Upload Section -->
            <section class="section upload-section">
                <div class="section-header">
                    <h2 class="section-title">Cargar Modelo 3D</h2>
                    <p class="section-subtitle">Sube tu archivo de infraestructura para explorarlo en 3D</p>
                </div>
                
                <div class="upload-container">
                    <div class="upload-zone" id="uploadZone">
                        <div class="upload-icon">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17,8 12,3 7,8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                        </div>
                        <h3>Arrastra tu archivo 3D aqu铆</h3>
                        <p>o haz clic para seleccionar</p>
                        <input type="file" id="fileInput" accept=".glb,.gltf,.obj,.fbx,.dae" style="display: none;">
                        <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()">
                            Seleccionar Archivo
                        </button>
                    </div>
                    
                    <div class="supported-formats">
                        <h4>Formatos soportados:</h4>
                        <div class="format-tags">
                            <span class="format-tag">.GLB</span>
                            <span class="format-tag">.GLTF</span>
                            <span class="format-tag">.OBJ</span>
                            <span class="format-tag">.FBX</span>
                            <span class="format-tag">.DAE</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 3D Viewer Section -->
            <section class="section viewer-section" id="viewer">
                <div class="section-header">
                    <h2 class="section-title">Visualizador 3D</h2>
                    <p class="section-subtitle">Interact煤a con el modelo usando mouse o controles t谩ctiles</p>
                </div>
                
                <div class="viewer-container">
                    <div class="viewer-wrapper">
                        <canvas id="viewer3D" class="viewer-canvas"></canvas>
                        
                        <!-- Loading Overlay -->
                        <div class="loading-overlay" id="loadingOverlay">
                            <div class="loading-spinner"></div>
                            <p>Cargando modelo 3D...</p>
                        </div>
                        
                        <!-- Controls Panel -->
                        <div class="controls-panel">
                            <div class="control-group">
                                <h4>Iluminaci贸n</h4>
                                <div class="control-item">
                                    <label>Luz Ambiental</label>
                                    <input type="range" id="ambientLight" min="0" max="1" step="0.1" value="0.5">
                                </div>
                                <div class="control-item">
                                    <label>Luz Direccional</label>
                                    <input type="range" id="directionalLight" min="0" max="2" step="0.1" value="1">
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <h4>Vista</h4>
                                <button class="control-btn" id="resetView">Restablecer Vista</button>
                                <button class="control-btn" id="wireframe">Ver Wireframe</button>
                            </div>
                            
                            <div class="control-group">
                                <h4>Informaci贸n</h4>
                                <div class="model-info" id="modelInfo">
                                    <p>Sube un modelo 3D para ver informaci贸n</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Instructions Section -->
            <section class="section instructions-section">
                <div class="section-header">
                    <h2 class="section-title">Instrucciones de Uso</h2>
                </div>
                
                <div class="instructions-grid">
                    <div class="instruction-card">
                        <div class="instruction-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="m2 12 4-4 4 4"></path>
                                <path d="m18 12 4-4-4-4"></path>
                                <path d="m12 2v6 10"></path>
                            </svg>
                        </div>
                        <h3>Rotar</h3>
                        <p>Mant茅n presionado el bot贸n izquierdo del mouse y arrastra para rotar la vista</p>
                    </div>
                    
                    <div class="instruction-card">
                        <div class="instruction-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="4" rx="1"></rect>
                                <rect x="3" y="16" width="18" height="4" rx="1"></rect>
                            </svg>
                        </div>
                        <h3>Desplazar</h3>
                        <p>Usa el bot贸n derecho del mouse o mant茅n Ctrl + arrastra para desplazar la vista</p>
                    </div>
                    
                    <div class="instruction-card">
                        <div class="instruction-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                        </div>
                        <h3>Zoom</h3>
                        <p>Usa la rueda del mouse o pellizca con dos dedos en pantalla t谩ctil</p>
                    </div>
                    
                    <div class="instruction-card">
                        <div class="instruction-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 3h18v18H3z"></path>
                                <path d="M3 9h18M9 21V9"></path>
                            </svg>
                        </div>
                        <h3>Wireframe</h3>
                        <p>Activa el modo wireframe para ver la estructura de alambres del modelo</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-brand">
                        <img src="images/LOGO-EPSA.png" alt="EPSA Logo" class="footer-logo">
                        <div>
                            <h3>EPSA BUSTILLO M.S</h3>
                            <p>Entidad Prestadora de Servicio de Agua potable y alcantarillado Sanitario</p>
                        </div>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Enlaces R谩pidos</h4>
                    <ul>
                        <li><a href="index.html">Inicio</a></li>
                        <li><a href="institucion.html">Instituci贸n</a></li>
                        <li><a href="servicios.html">Servicios</a></li>
                        <li><a href="contacto.html">Contacto</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Servicios</h4>
                    <ul>
                        <li><a href="servicios.html">Agua Potable</a></li>
                        <li><a href="servicios.html">Alcantarillado</a></li>
                        <li><a href="explorar.html">Explorar 3D</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Contacto</h4>
                    <p> Llallagua, Potos铆, Bolivia</p>
                    <p> +591 (2) 2XXXXXX</p>
                    <p> info@epsallallagua.com</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 EPSA BUSTILLO M.S - Entidad Prestadora de Servicio de Agua potable y alcantarillado Sanitario. Todos los derechos reservados.</p>
                <p>Desarrollado por: Victor Iba帽ez Gareca - <a href="https://wa.me/59160466476" target="_blank">WhatsApp</a></p>
            </div>
        </div>
    </footer>

    <!-- Additional CSS for 3D Viewer -->
    <style>
        .upload-section {
            background: linear-gradient(135deg, var(--primary-50), var(--accent-50));
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
        }
        
        .upload-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--space-lg);
            align-items: start;
        }
        
        .upload-zone {
            border: 2px dashed var(--primary-300);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            text-align: center;
            background: white;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .upload-zone:hover,
        .upload-zone.dragover {
            border-color: var(--primary-500);
            background: var(--primary-50);
            transform: translateY(-2px);
        }
        
        .upload-icon {
            color: var(--primary-500);
            margin-bottom: var(--space-md);
        }
        
        .supported-formats {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--neutral-200);
        }
        
        .format-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            margin-top: var(--space-sm);
        }
        
        .format-tag {
            background: var(--primary-100);
            color: var(--primary-700);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .viewer-section {
            background: white;
            border-radius: var(--radius-lg);
            padding: 0;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }
        
        .viewer-container {
            position: relative;
        }
        
        .viewer-wrapper {
            position: relative;
            height: 600px;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
        
        .viewer-canvas {
            width: 100%;
            height: 100%;
            display: block;
            cursor: grab;
        }
        
        .viewer-canvas:active {
            cursor: grabbing;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(30, 41, 59, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 10;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: var(--space-md);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .controls-panel {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            width: 280px;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }
        
        .control-group {
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--neutral-200);
        }
        
        .control-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .control-group h4 {
            color: var(--neutral-700);
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .control-item {
            margin-bottom: var(--space-sm);
        }
        
        .control-item label {
            display: block;
            font-size: 0.75rem;
            color: var(--neutral-600);
            margin-bottom: var(--space-xs);
        }
        
        .control-item input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            border-radius: 2px;
            background: var(--neutral-300);
            outline: none;
        }
        
        .control-item input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary-500);
            cursor: pointer;
        }
        
        .control-btn {
            width: 100%;
            padding: var(--space-sm);
            margin-bottom: var(--space-xs);
            border: 1px solid var(--neutral-300);
            border-radius: var(--radius-sm);
            background: white;
            color: var(--neutral-700);
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .control-btn:hover {
            background: var(--primary-50);
            border-color: var(--primary-300);
        }
        
        .model-info {
            font-size: 0.75rem;
            color: var(--neutral-600);
            background: var(--neutral-50);
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
        }
        
        .instructions-section {
            background: var(--neutral-50);
            border-radius: var(--radius-lg);
        }
        
        .instructions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }
        
        .instruction-card {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-md);
            text-align: center;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--neutral-200);
        }
        
        .instruction-icon {
            color: var(--primary-500);
            margin-bottom: var(--space-md);
        }
        
        .instruction-card h3 {
            color: var(--neutral-800);
            margin-bottom: var(--space-sm);
            font-size: 1.125rem;
        }
        
        .instruction-card p {
            color: var(--neutral-600);
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .upload-container {
                grid-template-columns: 1fr;
            }
            
            .viewer-wrapper {
                height: 400px;
            }
            
            .controls-panel {
                position: relative;
                top: auto;
                right: auto;
                width: 100%;
                margin-top: var(--space-md);
                border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            }
            
            .instructions-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <script src="scripts/main.js"></script>
    <script src="scripts/navigation.js"></script>
    
    <!-- 3D Viewer Logic -->
    <script src="scripts/3d-viewer.js"></script>
</body>
</html>